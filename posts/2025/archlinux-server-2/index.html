<!DOCTYPE html>
<html lang="zh" dir="auto" data-theme="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>折腾一台 Arch Linux 服务器 - 2 | STARRY-S&#39; Blog</title>
<meta name="keywords" content="Arch Linux">
<meta name="description" content="没想到这么短的时间把前阵子新组的服务器拆了换了一大堆配件……">
<meta name="author" content="STARRY-S">
<link rel="canonical" href="https://blog.starry-s.moe/posts/2025/archlinux-server-2/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.5ea96d65090d903c4b3b57af33f9766457193cbe3c48470b654d56684cce3656.css" integrity="sha256-XqltZQkNkDxLO1evM/l2ZFcZPL48SEcLZU1WaEzONlY=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://blog.starry-s.moe/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://blog.starry-s.moe/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://blog.starry-s.moe/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://blog.starry-s.moe/apple-touch-icon.png">
<link rel="mask-icon" href="https://blog.starry-s.moe/apple-touch-icon.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="https://blog.starry-s.moe/posts/2025/archlinux-server-2/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">
<script src="https://fastly.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>
<script src="https://fastly.jsdelivr.net/npm/meting/dist/Meting.min.js"></script>

<script>
  var meting_api='https://api.injahow.cn/meting/?server=:server&type=:type&id=:id&auth=:auth&r=:r';
</script><link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
<link rel="manifest" href="/site.webmanifest" />

<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#232323">
<meta property="og:url" content="https://blog.starry-s.moe/posts/2025/archlinux-server-2/">
  <meta property="og:site_name" content="STARRY-S&#39; Blog">
  <meta property="og:title" content="折腾一台 Arch Linux 服务器 - 2">
  <meta property="og:description" content="没想到这么短的时间把前阵子新组的服务器拆了换了一大堆配件……">
  <meta property="og:locale" content="zh">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-03-10T01:55:58+08:00">
    <meta property="article:modified_time" content="2025-03-30T21:41:20+08:00">
    <meta property="article:tag" content="Arch Linux">
      <meta property="og:image" content="https://blog.starry-s.moe/web-app-manifest-512x512.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://blog.starry-s.moe/web-app-manifest-512x512.png">
<meta name="twitter:title" content="折腾一台 Arch Linux 服务器 - 2">
<meta name="twitter:description" content="没想到这么短的时间把前阵子新组的服务器拆了换了一大堆配件……">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://blog.starry-s.moe/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "折腾一台 Arch Linux 服务器 - 2",
      "item": "https://blog.starry-s.moe/posts/2025/archlinux-server-2/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "折腾一台 Arch Linux 服务器 - 2",
  "name": "折腾一台 Arch Linux 服务器 - 2",
  "description": "没想到这么短的时间把前阵子新组的服务器拆了换了一大堆配件……\n",
  "keywords": [
    "Arch Linux"
  ],
  "articleBody": "没想到这么短的时间把前阵子新组的服务器拆了换了一大堆配件……\n起因是意识到 8 核 16 线程的 CPU 根本就满足不了咱对虚拟机的需求，然后就是 B550M 重炮手这主板带两张 2080Ti 显卡有点吃力，当主板插上两张显卡之后，第二槽的显卡是 PCIE 3.0x8 模式，第四槽的显卡只能运行在 PCIE 3.0x4，且第四槽不是一个单独的 IOMMU Group，而是和一堆其他主板设备共享总线。尽管这两张卡用 NVLink 连了起来性能应该不会有太大损耗，但卡二只能跑 PCIE 3.0x4 这个带宽实在有点不太能接受。\n其实一开始是看了几年前的 AMD EPYC 县城撕裂者 CPU，能搜到在卖的某宝店铺蛮少的，而且价格也偏贵，后来想了下就算换成 R9 5950X 这种 32 线程 CPU 也并不够用，于是逛 B 站找到了这套十年前的 Intel E5 V3 神机，虽然是十年前的服务器电脑，但性能数据和现在的 AMD 5600G 差不多，想来想去除了便宜这玩意应该没什么别的优点了，于是只花了 1600 块钱买了一套双路 E5 2696 V3 板 U 套装。然后还发现服务器的 DDR4 ECC 内存某宝上价格也特别便宜，一百多块钱就能买一根 32G 的条子，于是又买了 128G 的内存条，除此之外为了跑更多的虚拟机，咱还又加了根 2TB 的 NVME 硬盘。\n于是更新后的服务器配置变为：\n主板：华南 X99-F8D CPU：Intel E5 2696 V3 * 2（36 核心 72 线程） 内存：8 * DDR4 32G GPU：魔改 22G 显存 NVIDIA 2080 Ti * 2 (With NVLink) 硬盘：两根国产 PCIE 3.0 速率 NVME 固态，容量 2 TB * 2 机箱：先马黑洞 7pro 亿些静音风扇 电源：先马黑洞 1000W ATX 3.0 金牌 主板塞在机箱后的样子\nX99 主板开机有一段的自检时间，因为在换硬盘迁移文件的时候把系统搞崩了于是又不得不重装系统以及重装一些之前已部署过的虚拟机。以现在这个配置来看，这台电脑总算有一个服务器该有的配置了。尽管是十年前的老配置但 Linux 系统本身并不怎么吃性能，咱打算拿他开亿些虚拟机组集群折腾，发挥一下它仅剩的多核性能。至于显卡咱也不打算搞什么 vGPU 给虚拟机了，DKMS 驱动实在是太折腾了，而且咱有两张显卡，如果哪个虚拟机要显卡的话可以把某张空闲的卡直通到虚拟机里就好了，没必要拆卡来用了。这个华南的 X99-F8D 主板素质是要比 B550M 强很多的，两张 2080Ti 显卡其中一个能运行在 PCIE 3.0x16 模式，另一个是 PCIE 3.0x8 模式，然后他们都被划分在了单独的 IOMMU Group 里，所以能很轻易的就把他们直通给虚拟机。（这个主板有三根 PCIE 3.0X16 的插槽所以我甚至还能加一根 PCIE 延长线把之前买的 Tesla P4 也插在这个主板上，组三块显卡……）\n安装显卡和 CPU 散热\n这台服务器打算作为一个 BareMetal Server 装一个单节点的 RKE2 集群，用来运行一些 GPU 相关的服务，然后虚拟机里打算装几个 Harvester 节点，用来搞一些嵌套虚拟化之类的东西，像套娃一样在虚拟机里运行虚拟机、再在虚拟机里运行 K8s 集群，甚至还能在集群里运行一个虚拟机群，不过嵌套虚拟化的稳定性比单层的虚拟化差了好多实测总出一些各种奇怪的问题，折腾了很久也没搞清楚是什么问题所以就先不管他了，如果后续能折腾好所有咱遇到的奇怪问题有时间的话还能再水一篇博客。\n物理机上面咱在 RKE2 集群中部署了 Ollama、OpenWebUI 这些服务，可以跑一些本地的大模型，最多能跑 70b 模型，推理速度够用，这部分用起来都蛮舒服的没遇到什么问题，就是这个涡轮显卡风扇巨吵，推理过程和引擎发动一样嗷嗷响，等以后打算给他改成双风扇散热，解决一下噪音。\n快过年了，不要再讨论什么 Kubernetes、云原生、容器和虚拟化了。你带你的破笔记本电脑连着集群回到家，打开 kubectl，而朋友们兜里掏出一大把钱吃喝玩乐，你却用破电脑写着 Golang 代码，改你的 YAML Config，处理 CrashLoopBack。亲戚朋友吃饭问你这一年收获了什么，你说你搞了一台服务器，开了十几个虚拟机，组了几个高可用集群，还能嵌套虚拟化，运行虚拟集群。他们懵了，你还在心里默默嘲笑他们不懂 Kubernetes，不懂 KVM，不懂 Rancher，连 Docker 都是云里雾里，你接触的世界他们永远无法触及，你便是唯一拥有者。亲戚们都在说自己的子女一年的收获，儿子买了个房，女儿买了个车，而你的父母却默默无语，说我的孩子用攒一年的钱搞了个破铁盒子，整天嗡嗡响，电表越转越快了……\n最后是咱非常关心的耗电问题，咱把它插在小米的插座上用来监测电量，轻度使用一天大概 5 度电，一个月差不多 80 多块钱电费 (……\n后续 2025-03-30 补充\n因为涡轮显卡实在是太吵了，然后 128G 内存对于咱这堆虚拟机来说还是不太够用，于是又加了 4 根32G 内存条，共组成了 256G 的内存，然后还买了两张 2080Ti 双风扇版本的显卡散热器，给显卡改装了散热。\n改装显卡散热时因为咱这个不是公版显卡，所以需要把新买来的公版散热器中框用锯切掉一部分不然显卡尾部的电容会顶着中框。 然后丽台的显卡主板虽然有两个散热风扇接口但实际只有一个能用，所以需要用分线器将两个散热风扇连到一个接口上去。\n改装完成后就可以美滋滋的用这个服务器跑模型推理并折腾咱那一大堆虚拟机了。\n",
  "wordCount" : "1897",
  "inLanguage": "zh",
  "image": "https://blog.starry-s.moe/web-app-manifest-512x512.png","datePublished": "2025-03-10T01:55:58+08:00",
  "dateModified": "2025-03-30T21:41:20+08:00",
  "author":{
    "@type": "Person",
    "name": "STARRY-S"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://blog.starry-s.moe/posts/2025/archlinux-server-2/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "STARRY-S' Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://blog.starry-s.moe/favicon.ico"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://blog.starry-s.moe/" accesskey="h" title="Home (Alt + H)">
                <img src="https://blog.starry-s.moe/web-app-manifest-192x192.png" alt="" aria-label="logo"
                    height="24">Home</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://blog.starry-s.moe/gallery/" title="相册">
                    <span>相册</span>
                </a>
            </li>
            <li>
                <a href="https://blog.starry-s.moe/archives/" title="归档">
                    <span>归档</span>
                </a>
            </li>
            <li>
                <a href="https://blog.starry-s.moe/tags/" title="标签">
                    <span>标签</span>
                </a>
            </li>
            <li>
                <a href="https://blog.starry-s.moe/categories/" title="分类">
                    <span>分类</span>
                </a>
            </li>
            <li>
                <a href="https://blog.starry-s.moe/search/" title="搜索 (Alt &#43; /)" accesskey=/>
                    <span>搜索</span>
                </a>
            </li>
            <li>
                <a href="https://blog.starry-s.moe/projects/" title="项目">
                    <span>项目</span>
                </a>
            </li>
            <li>
                <a href="https://blog.starry-s.moe/about/" title="关于">
                    <span>关于</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://blog.starry-s.moe/">主页</a>&nbsp;»&nbsp;<a href="https://blog.starry-s.moe/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      折腾一台 Arch Linux 服务器 - 2
    </h1>
    <div class="post-meta"><span title='2025-03-10 01:55:58 +0800 +0800'>2025-03-10 01:55:58 +0800</span>&nbsp;·&nbsp;<span>4 分钟</span>&nbsp;·&nbsp;<span>1897 字</span>&nbsp;·&nbsp;<span>STARRY-S</span>&nbsp;|&nbsp;<span>
    <a href="https://github.com/STARRY-S/blog/edit/main/content/posts/2025/archlinux-server-2/index.md" rel="noopener noreferrer edit" target="_blank">Edit Text</a>
</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">目录</span>
        </summary>

        <div class="inner"><nav id="TableOfContents">
  <ul>
    <li><a href="#后续">后续</a></li>
  </ul>
</nav>
        </div>
    </details>
</div>

  <div class="post-content"><p>没想到这么短的时间把前阵子新组的服务器拆了换了一大堆配件……</p>
<meting-js server="netease" type="song" id="2634469026" theme="#233333"></meting-js>
<hr>
<p>起因是意识到 8 核 16 线程的 CPU 根本就满足不了咱对虚拟机的需求，然后就是 B550M 重炮手这主板带两张 2080Ti 显卡有点吃力，当主板插上两张显卡之后，第二槽的显卡是 PCIE 3.0x8 模式，第四槽的显卡只能运行在 PCIE 3.0x4，且第四槽不是一个单独的 IOMMU Group，而是和一堆其他主板设备共享总线。尽管这两张卡用 NVLink 连了起来性能应该不会有太大损耗，但卡二只能跑 PCIE 3.0x4 这个带宽实在有点不太能接受。</p>
<p>其实一开始是看了几年前的 AMD EPYC 县城撕裂者 CPU，能搜到在卖的某宝店铺蛮少的，而且价格也偏贵，后来想了下就算换成 R9 5950X 这种 32 线程 CPU 也并不够用，于是逛 B 站找到了这套十年前的 Intel E5 V3 神机，虽然是十年前的服务器电脑，但性能数据和现在的 AMD 5600G 差不多，想来想去除了便宜这玩意应该没什么别的优点了，于是只花了 1600 块钱买了一套双路 E5 2696 V3 板 U 套装。然后还发现服务器的 DDR4 ECC 内存某宝上价格也特别便宜，一百多块钱就能买一根 32G 的条子，于是又买了 128G 的内存条，除此之外为了跑更多的虚拟机，咱还又加了根 2TB 的 NVME 硬盘。</p>
<p>于是更新后的服务器配置变为：</p>
<ul>
<li>主板：华南 X99-F8D</li>
<li>CPU：Intel E5 2696 V3 * 2（36 核心 72 线程）</li>
<li>内存：8 * DDR4 32G</li>
<li>GPU：魔改 22G 显存 NVIDIA 2080 Ti * 2 (With NVLink)</li>
<li>硬盘：两根国产 PCIE 3.0 速率 NVME 固态，容量 2 TB * 2</li>
<li>机箱：先马黑洞 7pro</li>
<li>亿些静音风扇</li>
<li>电源：先马黑洞 1000W ATX 3.0 金牌</li>
</ul>
<p><img loading="lazy" src="images/1.jpg" alt="" />
<p style="margin-bottom: -0.8em;" class="image-title">主板塞在机箱后的样子</p>
</p>
<p>X99 主板开机有一段的自检时间，因为在换硬盘迁移文件的时候把系统搞崩了于是又不得不重装系统以及重装一些之前已部署过的虚拟机。以现在这个配置来看，这台电脑总算有一个服务器该有的配置了。尽管是十年前的老配置但 Linux 系统本身并不怎么吃性能，咱打算拿他开亿些虚拟机组集群折腾，发挥一下它仅剩的多核性能。至于显卡咱也不打算搞什么 vGPU 给虚拟机了，DKMS 驱动实在是太折腾了，而且咱有两张显卡，如果哪个虚拟机要显卡的话可以把某张空闲的卡直通到虚拟机里就好了，没必要拆卡来用了。这个华南的 X99-F8D 主板素质是要比 B550M 强很多的，两张 2080Ti 显卡其中一个能运行在 PCIE 3.0x16 模式，另一个是 PCIE 3.0x8 模式，然后他们都被划分在了单独的 IOMMU Group 里，所以能很轻易的就把他们直通给虚拟机。（这个主板有三根 PCIE 3.0X16 的插槽所以我甚至还能加一根 PCIE 延长线把之前买的 Tesla P4 也插在这个主板上，组三块显卡……）</p>
<p><img loading="lazy" src="images/2.jpg" alt="" />
<p style="margin-bottom: -0.8em;" class="image-title">安装显卡和 CPU 散热</p>
</p>
<p><img loading="lazy" src="images/3.png" alt="" />

</p>
<p>这台服务器打算作为一个 BareMetal Server 装一个单节点的 RKE2 集群，用来运行一些 GPU 相关的服务，然后虚拟机里打算装几个 Harvester 节点，用来搞一些嵌套虚拟化之类的东西，像套娃一样在虚拟机里运行虚拟机、再在虚拟机里运行 K8s 集群，甚至还能在集群里运行一个虚拟机群，不过嵌套虚拟化的稳定性比单层的虚拟化差了好多实测总出一些各种奇怪的问题，折腾了很久也没搞清楚是什么问题所以就先不管他了，如果后续能折腾好所有咱遇到的奇怪问题有时间的话还能再水一篇博客。</p>
<p>物理机上面咱在 RKE2 集群中部署了 Ollama、OpenWebUI 这些服务，可以跑一些本地的大模型，最多能跑 70b 模型，推理速度够用，这部分用起来都蛮舒服的没遇到什么问题，就是这个涡轮显卡风扇巨吵，推理过程和引擎发动一样嗷嗷响，等以后打算给他改成双风扇散热，解决一下噪音。</p>
<p><img loading="lazy" src="images/4.jpg" alt="" />

</p>
<blockquote>
<p>快过年了，不要再讨论什么 Kubernetes、云原生、容器和虚拟化了。你带你的破笔记本电脑连着集群回到家，打开 <code>kubectl</code>，而朋友们兜里掏出一大把钱吃喝玩乐，你却用破电脑写着 Golang 代码，改你的 YAML Config，处理 CrashLoopBack。亲戚朋友吃饭问你这一年收获了什么，你说你搞了一台服务器，开了十几个虚拟机，组了几个高可用集群，还能嵌套虚拟化，运行虚拟集群。他们懵了，你还在心里默默嘲笑他们不懂 Kubernetes，不懂 KVM，不懂 Rancher，连 Docker 都是云里雾里，你接触的世界他们永远无法触及，你便是唯一拥有者。亲戚们都在说自己的子女一年的收获，儿子买了个房，女儿买了个车，而你的父母却默默无语，说我的孩子用攒一年的钱搞了个破铁盒子，整天嗡嗡响，电表越转越快了……</p>
</blockquote>
<p>最后是咱非常关心的耗电问题，咱把它插在小米的插座上用来监测电量，轻度使用一天大概 5 度电，一个月差不多 80 多块钱电费 (……</p>
<h2 id="后续">后续<a hidden class="anchor" aria-hidden="true" href="#后续">#</a></h2>
<blockquote>
<p>2025-03-30 补充</p>
</blockquote>
<p>因为涡轮显卡实在是太吵了，然后 128G 内存对于咱这堆虚拟机来说还是不太够用，于是又加了 4 根32G 内存条，共组成了 256G 的内存，然后还买了两张 2080Ti 双风扇版本的显卡散热器，给显卡改装了散热。</p>
<p><img loading="lazy" src="images/5.jpg" alt="" />

</p>
<p><img loading="lazy" src="images/6.jpg" alt="" />

</p>
<p>改装显卡散热时因为咱这个不是公版显卡，所以需要把新买来的公版散热器中框用锯切掉一部分不然显卡尾部的电容会顶着中框。
然后丽台的显卡主板虽然有两个散热风扇接口但实际只有一个能用，所以需要用分线器将两个散热风扇连到一个接口上去。</p>
<p>改装完成后就可以美滋滋的用这个服务器跑模型推理并折腾咱那一大堆虚拟机了。</p>
<p><img loading="lazy" src="images/7.png" alt="" />

</p>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://blog.starry-s.moe/tags/arch-linux/">Arch Linux</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://blog.starry-s.moe/posts/2025/commencal-meta-ht/">
    <span class="title">« 上一页</span>
    <br>
    <span>十年过去了，我组了一台自己的山地车</span>
  </a>
  <a class="next" href="https://blog.starry-s.moe/posts/2025/archlinux-server/">
    <span class="title">下一页 »</span>
    <br>
    <span>折腾一台 Arch Linux 服务器</span>
  </a>
</nav>

  </footer><div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "starry-s-blog" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

</article>
    </main>
    
<footer class="footer">
        <span>© 2016 - 2026 STARRY-S | <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> | Hosted on <a href="https://pages.github.com">GitHub Pages</a><br /></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a><script>
  const pathname = window.location.pathname;
  const images = document.querySelectorAll('img');

  Array.from(images).forEach(image => {
    if (!pathname.includes("/posts/")) {
      return;
    }
    if (image.src.indexOf('images') < 0) {
      return
    }
    image.addEventListener('load', () => fitImage(image));
    if (image.complete && image.naturalWidth !== 0) {
      fitImage(image);
    }
  });

  function fitImage(image) {
    image.style.marginLeft = 'auto';
    image.style.marginRight = 'auto';
    
    if (image.naturalWidth / image.naturalHeight < 1.1) {
      image.style.maxWidth = '60%';
      image.style.height = 'auto';
    }
  }
</script>

<script src="/js/home-info.js"></script>


<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = '复制';

        function copyingDone() {
            copybutton.innerHTML = '已复制！';
            setTimeout(() => {
                copybutton.innerHTML = '复制';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
